text(cex=1, x=x-.25, y=0, my_data$Variable, xpd=TRUE, srt=45)
text(cex=1, x=x-.25, y=0, my_data$Variable, xpd=TRUE, srt=45)
text(cex=1, x=x-.25, y=0.01, my_data$Variable, xpd=TRUE, srt=45)
text(cex=1, x=x-.25, y=-0.01, my_data$Variable, xpd=TRUE, srt=45)
text(cex=1, x=x-.25, y=-0.005, my_data$Variable, xpd=TRUE, srt=45)
x <- barplot(my_data$Average)
text(cex=1, x=x-.25, y=-0.005, my_data$Variable, xpd=TRUE, srt=45)
text(cex=1, x=x-.25, y=-0.005, my_data$Variable, xpd=TRUE, srt=60)
x <- barplot(my_data$Average)
text(cex=1, x=x-.25, y=-0.005, my_data$Variable, xpd=TRUE, srt=60)
x <- barplot(my_data$Average)
text(cex=1, x=x-.4, y=-0.005, my_data$Variable, xpd=TRUE, srt=60)
axis(2, at=x,labels=x, col.axis="red", las=2)
axis(2, at=x,labels=x, col.axis="red", las=2)
axis(2, at=x,labels=x, col.axis="red", las=2)
x <- barplot(my_data$Average)
axis(2, at=x,labels=x, col.axis="red", las=2)
axis(2, at=x,labels=x, col.axis="red", las=2)
axis(2, at=x,labels=x, col.axis="red", las=2)
axis(1, at=x,labels=x, col.axis="red", las=2)
axis(1, at=x,labels=x, col.axis="white", las=2)
x <- barplot(my_data$Average)
axis(1, at=x,labels=x, col.axis="white", las=2)
axis(1, labels=F, col.axis="white", las=2)
x <- barplot(my_data$Average)
axis(1, labels=F, col.axis="white", las=2)
x <- barplot(my_data$Average)
axis(1, labels=F, col.axis="white", las=2)
axis(1, labels=F, col.axis="white", tick = F, las=2)
x <- barplot(my_data$Average)
axis(1, labels=F, col.axis="white", tick = F, las=2)
x <- barplot(my_data$Average)
axis(1, labels=F, col.axis="white", tick = F, las=2)
x <- barplot(my_data$Average)
axis(1, labels=F, col.axis="white", tick = F)
x <- barplot(my_data$Average)
axis(1, labels=F, col.axis="white")
x <- barplot(my_data$Average)
axis(1, labels=F, col.axis="white", tick = F, pos = c(4,4))
x <- barplot(my_data$Average)
axis(1, labels=F, col.axis="white", tick = T, pos = c(4,4))
par(mai = c(2,1))
par(mai = c(2,1,1,1))
x <- barplot(my_data$Average)
par(mai = c(1.5,0.5,0.5,0.5))
par(mai = c(1.5,0.5,0.5,0.5))
x <- barplot(my_data$Average)
par(mai = c(1.5,0.5,0.5,0.1))
x <- barplot(my_data$Average)
text(cex=1, x=x-.4, y=-0.005, my_data$Variable, xpd=TRUE, srt=60)
x <- barplot(my_data$Average)
text(cex=1, x=x-.4, y=-0.007, my_data$Variable, xpd=TRUE, srt=60)
x <- barplot(my_data$Average)
text(cex=1, x=x-.4, y=-0.009, my_data$Variable, xpd=TRUE, srt=60)
x <- barplot(my_data$Average)
text(cex=1, x=x-.4, y=-0.008, my_data$Variable, xpd=TRUE, srt=60)
x <- barplot(my_data$Average)
text(cex=1, x=x-.45, y=-0.008, my_data$Variable, xpd=TRUE, srt=60)
x <- barplot(my_data$Average)
text(cex=1, x=x-.45, y=-0.008, my_data$Variable, xpd=TRUE, srt=45)
x <- barplot(my_data$Average)
text(cex=1, x=x-.45, y=-0.006, my_data$Variable, xpd=TRUE, srt=45)
par(mai = c(1.3,0.5,0.5,0.1))
x <- barplot(my_data$Average)
text(cex=1, x=x-.45, y=-0.006, my_data$Variable, xpd=TRUE, srt=45)
x <- barplot(my_data$Average)
text(cex=1, x=x-.45, y=-0.0065, my_data$Variable, xpd=TRUE, srt=45)
x_axis <- x - 0.45
x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45, 0.45, 0.45,
0.45, 0.45)
length(c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45, 0.45, 0.45,
0.45, 0.45))
x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
0.45, 0.45, 0.45)
x <- barplot(my_data$Average)
x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
0.45, 0.45, 0.45)
text(cex=1, x= x_axis, y=-0.0065, my_data$Variable, xpd=TRUE, srt=45)
x <- barplot(my_data$Average)
x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
0.45, 0.45, 0.45)
text(cex=1, x= x_axis, y=-0.0065, my_data$Variable, xpd=TRUE, srt=60)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
0.45, 0.45, 0.45)
text(cex=1, x= x_axis, y=-0.007, my_data$Variable, xpd=TRUE, srt=60)
text(cex=1, x= x_axis, y=-0.007, my_data$Variable, xpd=TRUE, srt=60, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
0.45, 0.45, 0.45)
text(cex=1, x= x_axis, y=-0.007, my_data$Variable, xpd=TRUE, srt=60, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
0.45, 0.45, 0.45)
text(cex=1, x= x_axis, y=0, my_data$Variable, xpd=TRUE, srt=60, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
0.45, 0.45, 0.45)
text(cex=1, x= x_axis, y=0.02, my_data$Variable, xpd=TRUE, srt=60, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
0.45, 0.45, 0.45)
text(cex=1, x= x_axis, y=-0.02, my_data$Variable, xpd=TRUE, srt=60, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
0.45, 0.45, 0.45)
text(cex=1, x= x_axis, y=-0.002, my_data$Variable, xpd=TRUE, srt=60, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
0.45, 0.45, 0.45)
text(cex=1, x= x_axis, y=-0.001, my_data$Variable, xpd=TRUE, srt=60, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
0.45, 0.45, 0.45)
text(cex=1, x= -0.45, y=-0.001, my_data$Variable, xpd=TRUE, srt=60, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
# x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
#                 0.45, 0.45, 0.45)
text(cex=1, x= -0.45, y=-0.001, my_data$Variable, xpd=TRUE, srt=60, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
# x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
#                 0.45, 0.45, 0.45)
text(cex=1, x= -0.45, y=-0.001, my_data$Variable, xpd=TRUE, srt=60, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
# x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
#                 0.45, 0.45, 0.45)
text(cex=1, x= x - 0.45, y=-0.001, my_data$Variable, xpd=TRUE, srt=60, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
# x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
#                 0.45, 0.45, 0.45)
text(cex=1, x= x - 0.35, y=-0.001, my_data$Variable, xpd=TRUE, srt = 45, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
# x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
#                 0.45, 0.45, 0.45)
text(cex=1, x= x - 0.25, y=-0.001, my_data$Variable, xpd=TRUE, srt = 45, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
# x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
#                 0.45, 0.45, 0.45)
text(cex=1, x= x - 0.1, y=-0.001, my_data$Variable, xpd=TRUE, srt = 45, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
# x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
#                 0.45, 0.45, 0.45)
text(cex=1, x= x - 0.8, y=-0.001, my_data$Variable, xpd=TRUE, srt = 45, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
# x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
#                 0.45, 0.45, 0.45)
text(cex=1, x= x - 0.08, y=-0.001, my_data$Variable, xpd=TRUE, srt = 45, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
# x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
#                 0.45, 0.45, 0.45)
text(cex=1, x= x - 0.05, y=-0.001, my_data$Variable, xpd=TRUE, srt = 45, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
# x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
#                 0.45, 0.45, 0.45)
text(cex=1, x= x - 0.02, y=-0.001, my_data$Variable, xpd=TRUE, srt = 45, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
# x_axis <- x - c(0.5, 0.45, 0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,0.45, 0.45,
#                 0.45, 0.45, 0.45)
text(cex=1, x= x, y=-0.001, my_data$Variable, xpd=TRUE, srt = 45, adj = 1)
x <- barplot(my_data$Average)
axis(side=1, at=seq(0, 0.04, by = 0.01))
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average)
axis(side=2, at=seq(0, 0.04, by = 0.01))
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average, axes = F)
axis(side=2, at=seq(0, 0.04, by = 0.01))
text(cex=1, x = x, y=-0.001, my_data$Variable, xpd=TRUE, srt = 45, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average, axes = F, ylim = (0,0.4))
axis(side=2, at=seq(0, 0.04, by = 0.01))
text(cex=1, x = x, y=-0.001, my_data$Variable, xpd=TRUE, srt = 45, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average, axes = F, ylim = c(0,0.4))
axis(side=2, at=seq(0, 0.04, by = 0.01))
text(cex=1, x = x, y=-0.001, my_data$Variable, xpd=TRUE, srt = 45, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average, axes = F, ylim = c(0,0.4))
axis(side=2, at=seq(0, 0.04, by = 0.01))
text(cex=1, x = x, y=-0.001, my_data$Variable, xpd=TRUE, srt = 45, adj = 1)
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average, axes = F, ylim = c(0,0.04))
axis(side=2, at=seq(0, 0.04, by = 0.01))
text(cex=1, x = x, y=-0.001, my_data$Variable, xpd=TRUE, srt = 45, adj = 1)
my_data <- read.csv("figure5_data.csv")
tiff("Plot3.tiff", width = 10, height = 4, units = 'in', res = 1000)
my_data <- my_data[1:15, ]
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average, axes = F, ylim = c(0,0.04))
axis(side=2, at=seq(0, 0.04, by = 0.01))
text(cex=1, x = x, y=-0.001, my_data$Variable, xpd=TRUE, srt = 45, adj = 1)
dev.off()
my_data <- read.csv("figure5_data.csv")
tiff("figure5.tiff", width = 10, height = 4, units = 'in', res = 1000)
my_data <- my_data[1:15, ]
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average, axes = F, ylim = c(0,0.04))
axis(side=2, at=seq(0, 0.04, by = 0.01))
text(cex=1, x = x, y=-0.001, my_data$Variable, xpd=TRUE, srt = 45, adj = 1)
dev.off()
my_data <- read.csv("figure5_data.csv")
tiff("figure5.tiff", width = 10, height = 4, units = 'in', res = 1000)
my_data <- my_data[1:15, ]
par(mai = c(1.4,0.5,0.5,0.1))
x <- barplot(my_data$Average, axes = F, ylim = c(0,0.04))
axis(side=2, at=seq(0, 0.04, by = 0.01))
text(cex=1, x = x, y=-0.002, my_data$Variable, xpd=TRUE, srt = 45, adj = 1)
dev.off()
my_data <- read.csv("figure5_data.csv")
tiff("figure5.tiff", width = 10, height = 4, units = 'in', res = 1000)
my_data <- my_data[1:15, ]
par(mai = c(1.3,0.5,0.3,0.05))
x <- barplot(my_data$Average, axes = F, ylim = c(0,0.04))
axis(side=2, at=seq(0, 0.04, by = 0.01))
text(cex=1, x = x, y=-0.002, my_data$Variable, xpd=TRUE, srt = 45, adj = 1)
dev.off()
par(mai = c(1.3,0.5,0.3,0.01))
x <- barplot(my_data$Average, axes = F, ylim = c(0,0.04))
axis(side=2, at=seq(0, 0.04, by = 0.01))
text(cex=1, x = x, y=-0.002, my_data$Variable, xpd=TRUE, srt = 45, adj = 1)
dev.off()
library("rjson")
install.packages("rjson")
library("rjson")
my_data <- fromJSON(file = "C:\Users\rgurlek\Desktop\yelp_dataset")
my_data <- fromJSON(file = "C:/Users/rgurlek/Desktop/yelp_dataset")
install.packages("jsonlite")
install.packages("spotifyr")
library("spotifyr")
Sys.setenv(SPOTIFY_CLIENT_ID = '26399552a8ce4d1285397254189cac50')
Sys.setenv(SPOTIFY_CLIENT_SECRET = 'fdacfffa2dd34dbeb127dedb459f7ea3')
access_token <- get_spotify_access_token()
access_token <- get_spotify_access_token()
get_my_playlists()
get_track("spotify:track:6ndmKwWqMozN2tcZqzCX4K")
install.packages("installr")
library(installr)
R.version.string
updateR()
R.version.string
install.packages("knitr")
demand <- runif(1, 50, 150)
demand <- round(runif(1, 50, 150))
demand <- round(runif(1, 50, 150))
demand <- round(runif(1, 50, 150))
demand <- round(runif(1, 50, 150))
demand <- round(runif(1, 50, 150))
demand <- round(runif(1, 50, 150))
demand <- round(runif(1, 50, 150))
D <- round(runif(1, 50, 150))
pmin(c(10), c(5,15))
pmin(50:150, D)
p <- 12
c <- 9
R <- 50
ave_demand <- 100
perf <- p * pmin(50:150, D) - c * (59:150) - R
pmin(50:150, D)
p * pmin(50:150, D)
c * (59:150)
length(c * (59:150))
D <- round(runif(1, 50, 150))
perf <- p * pmin(50:150, D) - c * (50:150) - R
performance <- p * pmin(50:150, D) - c * (50:150) - R
D <- round(runif(1, 50, 150))
performance <- p * pmin(50:150, D) - c * (50:150) - R
length(50:150)
p <- 12
c <- 9
R <- 50
ave_demand <- 100
perf_hist <- matrix(NA, nrow = 1000, ncol = 101)
perf_hist[1,]
colnames(perf_hist) <- 50:150
View(perf_hist)
perf_hist[1,]
colnames(perf_hist)
p <- 12
c <- 9
R <- 50
ave_demand <- 100
n_rounds <- 1000
ma_window <- 10
all_hist <- matrix(NA, nrow = n_rounds, ncol = 101)
colnames(all_hist) <- 50:150
perf_hist <- matrix(NA, nrow = n_rounds, ncol = 4)
colnames(perf_hist) <- c("choice1", "profit1", "choice2", "profit2")
q1 <- 100
q2 <- 100
for(i in 1:n_rounds){
if(i != 1){
my_logic <- which.max(all_hist[i-1, ])
q1 <- colnames(all_hist)[my_logic]
my_logic <- which.max(colSums(all_hist[, min(1, i - 10):(i-1)]))
q2 <- colnames(all_hist)[my_logic]
}
profit1 <- p * pmin(q1, D) - c * (q1) - R
profit2 <- p * pmin(q2, D) - c * (q2) - R
perf_hist[i, ] <- c(q1, profit1, q2, profit2)
D <- round(runif(1, 50, 150))
all_hist[i, ] <- p * pmin(50:150, D) - c * (50:150) - R
}
c <- 9
R <- 50
ave_demand <- 100
n_rounds <- 1000
ma_window <- 10
all_hist <- matrix(NA, nrow = n_rounds, ncol = 101)
colnames(all_hist) <- 50:150
perf_hist <- matrix(NA, nrow = n_rounds, ncol = 4)
colnames(perf_hist) <- c("choice1", "profit1", "choice2", "profit2")
q1 <- 100
q2 <- 100
if(i != 1){
my_logic <- which.max(all_hist[i-1, ])
q1 <- colnames(all_hist)[my_logic]
my_logic <- which.max(colSums(all_hist[, min(1, i - 10):(i-1)]))
q2 <- colnames(all_hist)[my_logic]
}
profit1 <- p * pmin(q1, D) - c * (q1) - R
q1
D
p <- 12
c <- 9
R <- 50
ave_demand <- 100
n_rounds <- 1000
ma_window <- 10
all_hist <- matrix(NA, nrow = n_rounds, ncol = 101)
colnames(all_hist) <- 50:150
perf_hist <- matrix(NA, nrow = n_rounds, ncol = 4)
colnames(perf_hist) <- c("choice1", "profit1", "choice2", "profit2")
q1 <- 100
q2 <- 100
for(i in 1:n_rounds){
if(i != 1){
my_logic <- which.max(all_hist[i-1, ])
q1 <- colnames(all_hist)[my_logic]
my_logic <- which.max(colSums(all_hist[, min(1, i - 10):(i-1)]))
q2 <- colnames(all_hist)[my_logic]
}
D <- round(runif(1, 50, 150))
profit1 <- p * pmin(q1, D) - c * (q1) - R
profit2 <- p * pmin(q2, D) - c * (q2) - R
perf_hist[i, ] <- c(q1, profit1, q2, profit2)
all_hist[i, ] <- p * pmin(50:150, D) - c * (50:150) - R
}
min(1, i - 10):(i-1)
p <- 12
c <- 9
R <- 50
ave_demand <- 100
n_rounds <- 1000
ma_window <- 10
all_hist <- matrix(NA, nrow = n_rounds, ncol = 101)
colnames(all_hist) <- 50:150
perf_hist <- matrix(NA, nrow = n_rounds, ncol = 4)
colnames(perf_hist) <- c("choice1", "profit1", "choice2", "profit2")
q1 <- 100
q2 <- 100
for(i in 1:n_rounds){
if(i != 1){
my_logic <- which.max(all_hist[i-1, ])
q1 <- colnames(all_hist)[my_logic]
my_logic <- which.max(colSums(all_hist[, max(1, i - 10):(i-1)]))
q2 <- colnames(all_hist)[my_logic]
}
D <- round(runif(1, 50, 150))
profit1 <- p * pmin(q1, D) - c * (q1) - R
profit2 <- p * pmin(q2, D) - c * (q2) - R
perf_hist[i, ] <- c(q1, profit1, q2, profit2)
all_hist[i, ] <- p * pmin(50:150, D) - c * (50:150) - R
}
max(1, i - 10):(i-1)
all_hist[, max(1, i - 10):(i-1)]
p <- 12
c <- 9
R <- 50
ave_demand <- 100
n_rounds <- 1000
ma_window <- 10
all_hist <- matrix(NA, nrow = n_rounds, ncol = 101)
colnames(all_hist) <- 50:150
perf_hist <- matrix(NA, nrow = n_rounds, ncol = 4)
colnames(perf_hist) <- c("choice1", "profit1", "choice2", "profit2")
q1 <- 100
q2 <- 100
for(i in 1:n_rounds){
if(i != 1){
my_logic <- which.max(all_hist[i-1, ])
q1 <- colnames(all_hist)[my_logic]
my_logic <- which.max(colSums(all_hist[max(1, i - 10):(i-1), ]))
q2 <- colnames(all_hist)[my_logic]
}
D <- round(runif(1, 50, 150))
profit1 <- p * pmin(q1, D) - c * (q1) - R
profit2 <- p * pmin(q2, D) - c * (q2) - R
perf_hist[i, ] <- c(q1, profit1, q2, profit2)
all_hist[i, ] <- p * pmin(50:150, D) - c * (50:150) - R
}
1, i - 10):(i-1)
max(1, i - 10):(i-1)
all_hist[max(1, i - 10):(i-1), ]
all_hist[max(1, i - 10):(i-1), ,drop=FALSE]
p <- 12
c <- 9
R <- 50
ave_demand <- 100
n_rounds <- 1000
ma_window <- 10
all_hist <- matrix(NA, nrow = n_rounds, ncol = 101)
colnames(all_hist) <- 50:150
perf_hist <- matrix(NA, nrow = n_rounds, ncol = 4)
colnames(perf_hist) <- c("choice1", "profit1", "choice2", "profit2")
q1 <- 100
q2 <- 100
for(i in 1:n_rounds){
if(i != 1){
my_logic <- which.max(all_hist[i-1, ])
q1 <- colnames(all_hist)[my_logic]
my_logic <- which.max(colSums(all_hist[max(1, i - 10):(i-1), ,drop=FALSE]))
q2 <- colnames(all_hist)[my_logic]
}
D <- round(runif(1, 50, 150))
profit1 <- p * pmin(q1, D) - c * (q1) - R
profit2 <- p * pmin(q2, D) - c * (q2) - R
perf_hist[i, ] <- c(q1, profit1, q2, profit2)
all_hist[i, ] <- p * pmin(50:150, D) - c * (50:150) - R
}
p
pmin(q1, D)
q1
as.numeric(colnames(all_hist)[my_logic])
p <- 12
c <- 9
R <- 50
ave_demand <- 100
n_rounds <- 1000
ma_window <- 10
all_hist <- matrix(NA, nrow = n_rounds, ncol = 101)
colnames(all_hist) <- 50:150
perf_hist <- matrix(NA, nrow = n_rounds, ncol = 4)
colnames(perf_hist) <- c("choice1", "profit1", "choice2", "profit2")
q1 <- 100
q2 <- 100
for(i in 1:n_rounds){
if(i != 1){
my_logic <- which.max(all_hist[i-1, ])
q1 <- as.numeric(colnames(all_hist)[my_logic])
my_logic <- which.max(colSums(all_hist[max(1, i - 10):(i-1), ,drop=FALSE]))
q2 <- as.numeric(colnames(all_hist)[my_logic])
}
D <- round(runif(1, 50, 150))
profit1 <- p * pmin(q1, D) - c * (q1) - R
profit2 <- p * pmin(q2, D) - c * (q2) - R
perf_hist[i, ] <- c(q1, profit1, q2, profit2)
all_hist[i, ] <- p * pmin(50:150, D) - c * (50:150) - R
}
View(perf_hist)
summary(perf_hist)
p <- 12
c <- 9
R <- 50
ave_demand <- 100
n_rounds <- 10000
ma_window <- 10
all_hist <- matrix(NA, nrow = n_rounds, ncol = 101)
colnames(all_hist) <- 50:150
perf_hist <- matrix(NA, nrow = n_rounds, ncol = 4)
colnames(perf_hist) <- c("choice1", "profit1", "choice2", "profit2")
q1 <- 100
q2 <- 100
for(i in 1:n_rounds){
if(i != 1){
my_logic <- which.max(all_hist[i-1, ])
q1 <- as.numeric(colnames(all_hist)[my_logic])
my_logic <- which.max(colSums(all_hist[max(1, i - 10):(i-1), ,drop=FALSE]))
q2 <- as.numeric(colnames(all_hist)[my_logic])
}
D <- round(runif(1, 50, 150))
profit1 <- p * pmin(q1, D) - c * (q1) - R
profit2 <- p * pmin(q2, D) - c * (q2) - R
perf_hist[i, ] <- c(q1, profit1, q2, profit2)
all_hist[i, ] <- p * pmin(50:150, D) - c * (50:150) - R
}
summary(perf_hist)
help(package="FAIRforecast")
setwd("C:/Users/rgurlek/Desktop/yelp")
# rest_data contains a list of restaurant clusters around
# a border point. It is generated by collect_rest_data.R
rest_data <- readRDS("rest_data.rds")
View(rest_data)
rest_data[[1]]
